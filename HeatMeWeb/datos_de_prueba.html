<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="jquery-1.11.1.min.js"></script>
	</head>
	<body>
	<script type="text/javascript">
		(function() {
			var response = {"routes":[{"bounds":{"northeast":{"lat":-34.878117,"lng":-56.141933},"southwest":{"lat":-34.90961,"lng":-56.20547}},"copyrights":"Map data ©2014 Google","legs":[{"distance":{"text":"8.0 km","value":8029},"duration":{"text":"20 mins","value":1179},"end_address":"Buenos Aires, Montevideo 11000, Uruguay","end_location":{"lat":-34.908207,"lng":-56.20398},"start_address":"Agustín Sosa, Montevideo 11400, Uruguay","start_location":{"lat":-34.88182,"lng":-56.141933},"steps":[{"distance":{"text":"67 m","value":67},"duration":{"text":"1 min","value":5},"end_location":{"lat":-34.88213,"lng":-56.14257},"html_instructions":"Head southwest<\/b> on Agustín Sosa<\/b> toward Felipe Sanguinetti<\/b>","polyline":{"points":"jz{sE`ftuI|@~B"},"start_location":{"lat":-34.88182,"lng":-56.141933},"travel_mode":"DRIVING"},{"distance":{"text":"0.5 km","value":538},"duration":{"text":"2 mins","value":94},"end_location":{"lat":-34.878117,"lng":-56.14587},"html_instructions":"Take the 1st right<\/b> onto Felipe Sanguinetti<\/b>","polyline":{"points":"h|{sE`jtuIsB~Ay@p@ONgD`CMJq@j@iA`AGDiBpAs@h@kCrB"},"start_location":{"lat":-34.88213,"lng":-56.14257},"travel_mode":"DRIVING"},{"distance":{"text":"3.0 km","value":2961},"duration":{"text":"7 mins","value":444},"end_location":{"lat":-34.898136,"lng":-56.166286},"html_instructions":"Turn left<\/b> onto Av 8 de Octubre<\/b>","maneuver":"turn-left","polyline":{"points":"fc{sEt~tuIN\\~A~CP\\`BjDNVdFjK`ApBfD|Gf@~@R^JRLRj@bAjCnF`BhD`@x@f@p@HJBDx@x@bDbCnLdJzDlCnG`Fr@j@rLhJv@j@jB|AzB|ArCvBb@\\d@\\f@VZL^PdCbA|@^~CpApAh@`Ad@RHJFxA|@"},"start_location":{"lat":-34.878117,"lng":-56.14587},"travel_mode":"DRIVING"},{"distance":{"text":"3.1 km","value":3145},"duration":{"text":"7 mins","value":414},"end_location":{"lat":-34.906475,"lng":-56.19868},"html_instructions":"Slight right<\/b> onto Avenida 18 de Julio<\/b>","maneuver":"turn-slight-right","polyline":{"points":"h`_tEh~xuIDLb@zAPT`AbDhAbEpApExA|EbCfJrAvEp@`Cn@tBzApFBHlA~D|A|FlAhElAjEnAtEbAfDhAvDdCvIBNBP@P@h@FzAFbBB|@LbFN~EN`FHpB?^AX?FALAJ?L@J@H@JBPBNBN@ZHrBN~EP~ERpFJpEPxED~B"},"start_location":{"lat":-34.898136,"lng":-56.166286},"travel_mode":"DRIVING"},{"distance":{"text":"0.2 km","value":231},"duration":{"text":"1 min","value":34},"end_location":{"lat":-34.906116,"lng":-56.20075},"html_instructions":"Turn right<\/b> onto Plaza Independencia<\/b>","maneuver":"turn-right","polyline":{"points":"lt`tEvh_vIy@BI@GBCDEBCFAF?H@z@DfBLjE"},"start_location":{"lat":-34.906475,"lng":-56.19868},"travel_mode":"DRIVING"},{"distance":{"text":"0.4 km","value":375},"duration":{"text":"1 min","value":71},"end_location":{"lat":-34.9094,"lng":-56.200188},"html_instructions":"Turn left<\/b> to stay on Plaza Independencia<\/b>","maneuver":"turn-left","polyline":{"points":"fr`tEtu_vItACdAEj@G^Id@MvAk@|@Yf@KVCVATATAT@pAR"},"start_location":{"lat":-34.906116,"lng":-56.20075},"travel_mode":"DRIVING"},{"distance":{"text":"0.5 km","value":465},"duration":{"text":"1 min","value":54},"end_location":{"lat":-34.909504,"lng":-56.20504},"html_instructions":"Turn right<\/b> onto Camacuá<\/b>","maneuver":"turn-right","polyline":{"points":"vfatEdr_vILj@X|@BXAP]pB{@xGE\\QrAb@zBv@xD"},"start_location":{"lat":-34.9094,"lng":-56.200188},"travel_mode":"DRIVING"},{"distance":{"text":"0.1 km","value":102},"duration":{"text":"1 min","value":21},"end_location":{"lat":-34.90866,"lng":-56.20547},"html_instructions":"Turn right<\/b>","maneuver":"turn-right","polyline":{"points":"jgatEnp`vIgDtA"},"start_location":{"lat":-34.909504,"lng":-56.20504},"travel_mode":"DRIVING"},{"distance":{"text":"0.1 km","value":145},"duration":{"text":"1 min","value":42},"end_location":{"lat":-34.908207,"lng":-56.20398},"html_instructions":"Take the 1st right<\/b>Destination will be on the left<\/div>","polyline":{"points":"bbatEds`vIy@cE_@eB"},"start_location":{"lat":-34.90866,"lng":-56.20547},"travel_mode":"DRIVING"}],"via_waypoint":[]}],"overview_polyline":{"points":"jz{sE`ftuI|@~BsB~AiA`AuDlC{BlBqHtFbFfK~MrXtAfCvDrHbCbFp@|@|@~@rQhNzDlCnG`FfNtKbDhCzB|ArCvBhAz@bAd@dDtApJ`E^PxA|@DLb@zAPT`AbDhAbEjDnLvE~P`BvF~AzFfIrYrC|JnEnOF`@Bz@`@`Nh@rQEz@Dn@LlA~@dXJpEPxED~By@BQDIHEN@dARrHzCIjAQ|By@dBe@n@Ej@CfBTf@hB@j@]pB{@xGWpBzAtHgDtAy@cE_@eB"},"summary":"Av 8 de Octubre and Avenida 18 de Julio","warnings":[],"waypoint_order":[]}],"status":"OK"};

			var fechalog = null;
			var tipo = 2;
			var date = new Date(2014, 8, 8, 0, 0, 0, 0);
			var ochoAM = new Date(2014, 8, 8, 9, 07, 0, 0).getTime();
			var siesPM = new Date(2014, 8, 8, 18, 12, 0, 0).getTime();
			var docePM = new Date(2014, 8, 8, 23, 59, 0, 0).getTime();
			var start_lat = response.routes[0].legs[0].start_location.lat;
			var start_lng = response.routes[0].legs[0].start_location.lng;
			var end_lat = response.routes[0].legs[0].end_location.lat;
			var end_lng = response.routes[0].legs[0].end_location.lng;
			var timestamp = date.getTime();
			for (var j = timestamp; j < ochoAM; j += 60000)
			{
				timestamp += 60000;
				$.ajax({
					type : "POST",
					url: 'http://162.248.53.11:8080/locationUpdateTest',
					data: "timestamp=" + timestamp + "&latitud=" + start_lat + "&longitud=" + start_lng + "&tipo=" + tipo,
					contentType: 'application/x-www-form-urlencoded',
				}).done(function(data){
					console.log('Success durmiendo: ' + JSON.stringify(data));
				}).fail(function(jqXHR, textStatus) {
					console.log('Error: ' + textStatus);
				});
			}

			//fechalog = new Date(timestamp);
			//console.log(timestamp);

			var steps = response.routes[0].legs[0].steps;
			steps.forEach(function (step){
				var milisecs = ((step.duration.text).split(' ')[0]) * 1000 * 60;
				var latitud = step.start_location.lat;
				var longitud = step.start_location.lng;
				//console.log('timestamp: '+ timestamp +' milisec: '+ milisecs +' latitud: '+ latitud +' longitud: '+ longitud);
				for (var i = 1000 * 60; i <= milisecs; i += 60000)
				{
					timestamp += 60000;
					//console.log('date sent: ' + timestamp + ' i: ' + i);
					$.ajax({
						type : "POST",
						url: 'http://162.248.53.11:8080/locationUpdateTest',
						data: "timestamp=" + timestamp + "&latitud=" + latitud + "&longitud=" + longitud + "&tipo=" + tipo,
						contentType: 'application/x-www-form-urlencoded',
					}).done(function(data){
						 console.log('Success yendo al trabajo: ' + JSON.stringify(data));
					}).fail(function(jqXHR, textStatus) {
						console.log('Error: ' + textStatus);
					});
				}
			})
			
			//fechalog = new Date(timestamp);
			//console.log(timestamp);

			for (var j = timestamp; j < siesPM; j += 60000)
			{
				timestamp += 60000;
				$.ajax({
					type : "POST",
					url: 'http://162.248.53.11:8080/locationUpdateTest',
					data: "timestamp=" + timestamp + "&latitud=" + end_lat + "&longitud=" + end_lng + "&tipo=" + tipo,
					contentType: 'application/x-www-form-urlencoded',
				}).done(function(data){
					console.log('Success trabajando: ' + JSON.stringify(data));
				}).fail(function(jqXHR, textStatus) {
					console.log('Error: ' + textStatus);
				});
			}

			//fechalog = new Date(timestamp);
			//console.log(timestamp);

			for (var k = steps.length - 1; k >= 0; k--) {
				var step = steps[k];
				//console.log('step: ' + k);
				var milisecs = ((step.duration.text).split(' ')[0]) * 1000 * 60;
				var latitud = step.start_location.lat;
				var longitud = step.start_location.lng;
				//console.log('timestamp: '+ timestamp +' milisec: '+ milisecs +' latitud: '+ latitud +' longitud: '+ longitud);
				for (var i = 1000 * 60; i <= milisecs; i += 60000)
				{
					timestamp += 60000;
					//console.log('date sent: ' + timestamp + ' i: ' + i);
					$.ajax({
						type : "POST",
						url: 'http://162.248.53.11:8080/locationUpdateTest',
						data: "timestamp=" + timestamp + "&latitud=" + latitud + "&longitud=" + longitud + "&tipo=" + tipo,
						contentType: 'application/x-www-form-urlencoded',
					}).done(function(data){
						 console.log('Success regreso a casa: ' + JSON.stringify(data));
					}).fail(function(jqXHR, textStatus) {
						console.log('Error: ' + textStatus);
					});
				}
			};

			//fechalog = new Date(timestamp);
			//console.log(timestamp);

			for (var j = timestamp; j < docePM; j += 60000)
			{
				timestamp += 60000;
				$.ajax({
					type : "POST",
					url: 'http://162.248.53.11:8080/locationUpdateTest',
					data: "timestamp=" + timestamp + "&latitud=" + start_lat + "&longitud=" + start_lng + "&tipo=" + tipo,
					contentType: 'application/x-www-form-urlencoded',
				}).done(function(data){
					console.log('Success 12 PM: ' + JSON.stringify(data));
				}).fail(function(jqXHR, textStatus) {
					console.log('Error: ' + textStatus);
				});
			}

			fechalog = new Date(timestamp);
			console.log(timestamp);
		})();
    </script>
	</body>
</html>


